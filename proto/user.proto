syntax = "proto3";

package jjtsksn.user.v2;

option go_package = "github.com/jjtsksn/us-proto/go/user/v2;user_v2";

import "google/protobuf/timestamp.proto";
import "easyp_vendor/buf/validate/validate.proto";

// User Service
service UserService {
  rpc CreateOrGetUserFromTelegram (CreateOrGetUserFromTelegramRequest) returns (CreateOrGetUserFromTelegramResponse);
}
// MODELS
message TelegramUser {
  int64 id = 1 [(buf.validate.field).int64.gte = 1];
  optional string username = 2 [(buf.validate.field).string.pattern = "^[a-zA-Z0-9_]{5,32}$"];
}

message User {
  string uuid = 1 [(buf.validate.field).string.uuid = true];
  google.protobuf.Timestamp created_at = 2 [(buf.validate.field).required = true];
  bool is_active = 3 [(buf.validate.field).required = true];
  optional TelegramUser telegram_user = 4;
}

// CREATE_OR_GET_USER
message CreateOrGetUserFromTelegramRequest {
  TelegramUser telegram_user = 1 [(buf.validate.field).required = true];
}
message CreateOrGetUserFromTelegramResponse {
  User user = 1 [(buf.validate.field).required = true];
}